<div class="container-fluid main">
    <div class="background mb-2">
        <div class="p-2 head">
            <h2>Trouvez la carrière que vous méritez</h2>

            <p>Votre recherche d'emploi commence et se termine avec nous</p>
        </div>
    </div>

    <div class="mt-5" *ngIf="numberOfOffres == 0; else show">
        <h2 class="text-muted text-center">Aucune offre disponible</h2>
    </div>

    <ng-template #show>
        <div
            class="row p-xl-5 p-md-2 p-sm-2 justify-content-sm-center justify-content-md-start justify-content-lg-start">
            <div class="col-xl-4 col-md-6 col-sm-10 mb-5" *ngFor="let offre of listOffres ; let i = index">
                <div class="offre-card mb-2">
                    <div class="offre-card-body">
                        <div class="row">
                            <div class="col-12">
                                <div class="d-flex justify-content-center offre-image">
                                    <img [src]="listImages[i]" alt="img">
                                </div>

                                <div class="offre-description">

                                    <div class="mb-3">
                                        <p class="text-muted"> {{offre.entreprise.nomEntreprise}} </p>
                                    </div>

                                    <div class="mb-1">
                                        <i class="fas fa-map-marker-alt fa-lg text-muted me-2"></i>
                                        <span style="background-color: #33b8e854; color: #fff; border-radius: 5px;">
                                            {{offre.adresseOffre}} </span>
                                    </div>
                                    <div class="mb-3">
                                        <div class="mb-1">
                                            <i class="fas fa-briefcase text-muted me-2"></i>
                                            <span class="text-muted"> {{offre.titreOffre}}</span>
                                        </div>

                                        <small class="text-muted">
                                            {{offre.exigenceOffre}}
                                        </small>
                                    </div>

                                    <div class="mb-1 job-desc">
                                        <div class="mb-1">
                                            <i class="fas fa-landmark text-muted me-2"></i>
                                            <span class="text-muted">Entreprise </span>
                                        </div>
                                        <p class="text-muted">
                                            {{offre.entreprise.descriptionEnt}}
                                        </p>
                                    </div>

                                    <div class="mb-3">
                                        <div class="mb-1">
                                            <i class="fas fa-envelope text-muted me-2"></i>
                                            <span class="text-muted"> {{offre.entreprise.emailEnt}} </span>
                                        </div>
                                        <div class="mb-1">
                                            <i class="fas fa-phone  text-muted me-2"></i>
                                            <span class="text-muted"> {{offre.entreprise.telephoneEnt}} </span>
                                        </div>
                                    </div>

                                    <div *ngIf="auth.isConnected == true && auth.loggedUserRole == 'EMP'" class="mb-1 d-flex justify-content-center">
                                        <button class="btn-ent" data-bs-toggle="modal"
                                            attr.data-bs-target="{{'#id' + i}}">Postuler ici</button>
                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>
                </div>

                <div class="modal fade" id="{{'id' + i}}" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content font-sans-serif">
                            <div class="modal-header">
                                <p class="modal-title fs-5" id="exampleModalLabel">Postuler chez
                                    {{offre.entreprise.nomEntreprise}} </p>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <small class="fs-6 fw-bold">Contact info</small>
                                <div class="d-flex">
                                    <div class="user-contact-image">
                                        <img src="../../assets/undraw_profile_pic_ic-5-t.svg" alt="img">
                                    </div>

                                    <div class="user-contact-desc">
                                        <div>
                                            <p> {{auth.loggedUser}} </p>
                                        </div>
                                        <div>
                                            <small>Connecté <i class="fas fa-circle ms-1 text-success" style="font-size: 8px;"></i> </small>
                                        </div>
                                    </div>
                                </div>

                                <form class="form mb-5">
                                    <div class="d-flex justify-content-between">
                                        <div class="ligne" style="width: 49%;">
                                            <div class="ligne-item">
                                                <label for="name" class="mb-3">Nom*</label>
                                                <input type="text" style="font-size: 15px;"
                                                    [(ngModel)]="post.nomCondidat" [ngModelOptions]="{standalone: true}"
                                                    id="{{'name' + i}}" class="ligne-form mb-3">
                                            </div>
                                        </div>
                                        <div class="ligne" style="width: 49%;">
                                            <div class="ligne-item">
                                                <label for="lastname" class="mb-3">Prenom*</label>
                                                <input type="text" style="font-size: 15px;"
                                                    [(ngModel)]="post.prenomCondidat"
                                                    [ngModelOptions]="{standalone: true}" id="{{'lastname' + i}}"
                                                    class="ligne-form mb-3">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <div class="ligne" style="width: 49%;">
                                            <div class="ligne-item">
                                                <label for="email" class="mb-3">Adresse email*</label>
                                                <input type="email" style="font-size: 15px;"
                                                    [(ngModel)]="post.emailCondidat"
                                                    [ngModelOptions]="{standalone: true}" id="{{'email' + i}}"
                                                    class="ligne-form mb-3">
                                            </div>
                                        </div>

                                        <div class="ligne" style="width: 49%;">
                                            <div class="ligne-item">
                                                <label for="tel" class="mb-3">Téléphone*</label>
                                                <input type="tel" style="font-size: 15px;"
                                                    [(ngModel)]="post.telCondidat" [ngModelOptions]="{standalone: true}"
                                                    id="{{'tel' + i}}" class="ligne-form mb-3">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="ligne">
                                        <div class="ligne-item">
                                            <label for="cv" class="mb-3">CV*</label>
                                            <input type="file" (change)="onFileChanged($event)"
                                                style="font-size: 20px; border-bottom: none;" id="{{'cv' + i}}"
                                                class="ligne-form mb-3">
                                        </div>
                                    </div>
                                </form>

                                <div *ngIf="dataSended">
                                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                                        <strong><i class="fas fa-check-circle fa-lg me-2"></i></strong> Postulation envoyé avec succès
                                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                    </div>
                                </div>

                                <div>
                                    <small>L’envoi de cette candidature ne modifiera pas votre profil SDE.</small>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn-ent" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn-emp"
                                    (click)="sendData(offre.idOffre)">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>

</div>